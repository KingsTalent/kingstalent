import{_ as u,s as r,m as d,o as i,c as n,a as h,b as l,p as g,d as m}from"./index-KoIWAuDc.js";const p={data(){return{isLoggedIn:!1,userData1:null}},methods:{async signInWithGoogle(){try{const{user:s,session:e,error:t}=await r.auth.signInWithOAuth({provider:"google"});if(t)throw t;console.log("登录成功",s,e),this.isLoggedIn=!0,this.userData1=s}catch(s){console.error("登录失败",s.message)}},async checkUserSession(){console.log("開始檢查");const s=await r.auth.getSession();if(s.data.session){await this.$store.dispatch("fetchUser",s.data.session.user.email);const e=this.$store.state.lv.index||"/";this.$router.push(e);const t=this.$store.state.lv.item||[];await this.$store.dispatch("fetchDataFromItems",t),console.log("数据:",this.$store.state)}else this.$router.push("/")},async signOut(){try{const{error:s}=await r.auth.signOut();if(s)throw s;this.$store.commit("resetState"),console.log("登出成功")}catch(s){console.error("登出失败",s.message)}}},mounted(){this.checkUserSession()},computed:{...d(["userData","tableData","setlv"])}},I=s=>(g("data-v-dcc9a16e"),s=s(),m(),s),f=I(()=>l("h1",null,"欢迎来到首页",-1)),_={key:1};function k(s,e,t,v,c,o){return i(),n("div",null,[f,c.isLoggedIn?h("",!0):(i(),n("button",{key:0,onClick:e[0]||(e[0]=(...a)=>o.signInWithGoogle&&o.signInWithGoogle(...a))},"使用 Google 登录")),l("button",{onClick:e[1]||(e[1]=(...a)=>o.signOut&&o.signOut(...a))},"登出"),c.isLoggedIn?(i(),n("div",_)):h("",!0)])}const S=u(p,[["render",k],["__scopeId","data-v-dcc9a16e"]]);export{S as default};
