import{_ as d,s as i,m as g,o as r,c,a as u,b as h,p,d as m}from"./index-cuFQDSFc.js";const I={data(){return{isLoggedIn:!1,userData1:null}},methods:{async signInWithGoogle(){try{const s=window.open("","_blank"),{user:e,session:t,error:a}=await i.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.href,shouldCreatePopup:!0}});if(a)throw a;s&&s.close(),console.log("登录成功",e,t),this.isLoggedIn=!0,this.userData1=e}catch(s){console.error("登录失败",s.message),signInWindow&&signInWindow.close()}},async checkUserSession(){const s=await i.auth.getSession();if(s.data.session){await this.$store.dispatch("fetchUser",s.data.session.user.email);const e=this.$store.state.lv.index||"/";this.$router.push(e);const t=this.$store.state.lv.item||[];await this.$store.dispatch("fetchDataFromItems",t),console.log("数据:",this.$store.state)}else this.$router.push("/")},async signOut(){try{const{error:s}=await i.auth.signOut();if(s)throw s;this.$store.commit("resetState"),console.log("登出成功")}catch(s){console.error("登出失败",s.message)}}},mounted(){this.checkUserSession()},computed:{...g(["userData","tableData","setlv"])}},f=s=>(p("data-v-23a5a071"),s=s(),m(),s),w=f(()=>h("h1",null,"欢迎来到首页",-1)),_={key:1};function k(s,e,t,a,l,o){return r(),c("div",null,[w,l.isLoggedIn?u("",!0):(r(),c("button",{key:0,onClick:e[0]||(e[0]=(...n)=>o.signInWithGoogle&&o.signInWithGoogle(...n))},"使用 Google 登录")),h("button",{onClick:e[1]||(e[1]=(...n)=>o.signOut&&o.signOut(...n))},"登出"),l.isLoggedIn?(r(),c("div",_)):u("",!0)])}const S=d(I,[["render",k],["__scopeId","data-v-23a5a071"]]);export{S as default};
